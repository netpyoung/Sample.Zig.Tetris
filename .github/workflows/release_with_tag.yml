name: ğŸš€ğŸ·ï¸ Release with Tag

on:
  push:
    tags:
      - '*'
#    branches:
#      - main

jobs:
  upload_assets_for_windows:
    name: ğŸªŸğŸ“¦ï¸ Upload Assets
    runs-on: windows-latest
    steps:
      # https://github.com/actions/checkout
      - name: checkout
        uses: actions/checkout@v5

      # https://codeberg.org/mlugg/setup-zig/
      - name: setup zig
        uses: mlugg/setup-zig@v2
        with:
          version: 0.15.2

      # https://github.com/actions/cache
      - name: Cache Zig build
        uses: actions/cache@v4
        with:
          path: ~/.cache/zig
          key: zig-${{ runner.os }}-${{ hashFiles('**/*.zig') }}
          restore-keys: |
            zig-${{ runner.os }}-

      - name: install deps
        shell: pwsh
        run: |
          .\install_deps_windows.ps1
      - name: build
        shell: pwsh
        run: |
          Push-Location Sample.Zig.Tetris/SampleZigTetris_raylib
          zig build -Doptimize=ReleaseFast
          Pop-Location # Sample.Zig.Tetris/SampleZigTetris_raylib


      - name: ğŸ“¦ï¸â« Upload Artifact - SampleZigTetris_raylib
        uses: actions/upload-artifact@v4
        with:
          name: artifact-windows-exe
          path: Sample.Zig.Tetris/SampleZigTetris_raylib/zig-out/bin/SampleZigTetris_raylib.exe
          if-no-files-found: error
          retention-days: 1
          compression-level: 0